!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["ubx-parser"]=e():r["ubx-parser"]=e()}(this,(()=>(()=>{"use strict";var r={89:(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PacketParser=void 0;var t=function(){function r(r,e){this.packet_class=r,this.packet_id=e}return r.prototype.compareSignature=function(r,e){return this.packet_class==r&&this.packet_id==e},r}();e.PacketParser=t},609:(r,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UBXParser=void 0;var n=t(508),a=t(299),o=t(425),i=function(){function r(){this.parsers=[],this.packetListeners=new Map,this.localBuffer=Buffer.from(""),this.registerParser(new o.UBX_NAV_PVT_Parser),this.registerParser(new a.UBX_ESF_STATUS_Parser),this.registerParser(new n.UBX_ESF_MEAS_Parser)}return r.prototype.parse=function(r){var e,t,n,a=this;this.localBuffer=Buffer.concat([this.localBuffer,r]);for(var o=function(){var r=i.localBuffer.indexOf(Buffer.from([181,98])),o=i.localBuffer.indexOf(Buffer.from([181,98]),2);if(0!=r&&o>0)return i.localBuffer=i.localBuffer.subarray(o),{value:null===(e=i.packetListeners.get("warning"))||void 0===e?void 0:e.forEach((function(r){return r(new Error("invalide packet droped"),void 0)}))};if(0!=r||-1==o)return{value:void 0};var s=i.localBuffer.subarray(0,o);if(i.localBuffer=i.localBuffer.subarray(o),s.length<8)return{value:null===(t=i.packetListeners.get("error"))||void 0===t?void 0:t.forEach((function(r){return r(new Error("invalide packet size"),s)}))};var d=s.readUInt8(2),u=s.readUInt8(3),c=s.readUInt16LE(4),f=s.subarray(6,6+c);if(f.length!=c)return{value:null===(n=i.packetListeners.get("error"))||void 0===n?void 0:n.forEach((function(r){return r(new Error("invalide packet payload"),s)}))};i.parsers.forEach((function(r){var e;r.compareSignature(d,u)&&(null===(e=a.packetListeners.get("data"))||void 0===e||e.forEach((function(e){var t;try{var n=r.parse(f);n.packet_class=d,n.packet_id=u,e(n,s)}catch(r){null===(t=a.packetListeners.get("error"))||void 0===t||t.forEach((function(e){return e(r,s)}))}})))}))},i=this;this.localBuffer.length>0;){var s=o();if("object"==typeof s)return s.value}},r.prototype.registerParser=function(r){this.parsers.push(r)},r.prototype.unregisterParser=function(r){this.parsers=this.parsers.filter((function(e){return e!=r}))},r.prototype.on=function(r,e){var t;this.packetListeners.has(r)?null===(t=this.packetListeners.get(r))||void 0===t||t.push(e):this.packetListeners.set(r,[e])},r}();e.UBXParser=i},287:(r,e)=>{function t(r,e,t){return void 0===e&&(e=0),void 0===t&&(t=1),(r&255>>8-t<<e)>>e}function n(r,e,n){if(void 0===e&&(e=0),void 0===n&&(n=1),e<=7&&e+n>8){var a=t(255&r,e,e+n>8?8-e:n);return t(r>>8&255,0,e+n-8)<<8-e|a}return e<=7?t(r,e,n):t(r>>8&255,e-8,n)}Object.defineProperty(e,"__esModule",{value:!0}),e.readBitFromUInt32=e.readBitFromUInt16=e.readBitFromUInt8=void 0,e.readBitFromUInt8=t,e.readBitFromUInt16=n,e.readBitFromUInt32=function(r,e,t){if(void 0===e&&(e=0),void 0===t&&(t=1),e<=15&&e+t>16){var a=n(65535&r,e,e+t>16?16-e:t);return n(r>>16&65535,0,e+t-16)<<16-e|a}return e<=15?n(r,e,t):n(r>>16&65535,e-16,t)}},432:function(r,e,t){var n=this&&this.__createBinding||(Object.create?function(r,e,t,n){void 0===n&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,a)}:function(r,e,t,n){void 0===n&&(n=t),r[n]=e[t]}),a=this&&this.__exportStar||function(r,e){for(var t in r)"default"===t||Object.prototype.hasOwnProperty.call(e,t)||n(e,r,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_ESF_MEAS_Parser=e.UBX_ESF_STATUS_Parser=e.UBX_NAV_PVT_Parser=e.UBX_MON_VER_Parser=e.UBX_NAV_SAT_Parser=e.readBitFromUInt32=e.readBitFromUInt16=e.readBitFromUInt8=e.PacketParser=e.UBXParser=void 0;var o=t(609);Object.defineProperty(e,"UBXParser",{enumerable:!0,get:function(){return o.UBXParser}});var i=t(89);Object.defineProperty(e,"PacketParser",{enumerable:!0,get:function(){return i.PacketParser}});var s=t(287);Object.defineProperty(e,"readBitFromUInt8",{enumerable:!0,get:function(){return s.readBitFromUInt8}}),Object.defineProperty(e,"readBitFromUInt16",{enumerable:!0,get:function(){return s.readBitFromUInt16}}),Object.defineProperty(e,"readBitFromUInt32",{enumerable:!0,get:function(){return s.readBitFromUInt32}});var d=t(477);Object.defineProperty(e,"UBX_NAV_SAT_Parser",{enumerable:!0,get:function(){return d.UBX_NAV_SAT_Parser}});var u=t(425);Object.defineProperty(e,"UBX_NAV_PVT_Parser",{enumerable:!0,get:function(){return u.UBX_NAV_PVT_Parser}});var c=t(633);Object.defineProperty(e,"UBX_MON_VER_Parser",{enumerable:!0,get:function(){return c.UBX_MON_VER_Parser}});var f=t(299);Object.defineProperty(e,"UBX_ESF_STATUS_Parser",{enumerable:!0,get:function(){return f.UBX_ESF_STATUS_Parser}});var U=t(508);Object.defineProperty(e,"UBX_ESF_MEAS_Parser",{enumerable:!0,get:function(){return U.UBX_ESF_MEAS_Parser}}),a(t(855),e)},508:function(r,e,t){var n,a=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_ESF_MEAS_Parser=void 0;var o=t(287),i=function(r){function e(){return r.call(this,16,2)||this}return a(e,r),e.prototype.parse=function(r){for(var e={timeTag:r.readUInt32LE(0),timeMarkSent:(0,o.readBitFromUInt16)(r.readUInt16LE(4),0,2),timeMarkEdge:(0,o.readBitFromUInt16)(r.readUInt16LE(4),2),calibTtagValid:1==(0,o.readBitFromUInt16)(r.readUInt16LE(4),3),numMeas:(0,o.readBitFromUInt16)(r.readUInt16LE(4),11,5),measurements:[]},t=0;t<e.numMeas;t++){var n=r.subarray(8+4*t,12+4*t);4==n.length&&e.measurements.push({dataField:(0,o.readBitFromUInt32)(n.readUInt32LE(0),0,24),dataType:(0,o.readBitFromUInt32)(n.readUInt32LE(0),24,6),calibTtag:r.readUInt32LE(1)})}return e},e}(t(89).PacketParser);e.UBX_ESF_MEAS_Parser=i},299:function(r,e,t){var n,a=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_ESF_STATUS_Parser=void 0;var o=t(287),i=function(r){function e(){return r.call(this,16,16)||this}return a(e,r),e.prototype.parse=function(r){for(var e={iTOW:r.readUInt32LE(0),version:r.readUInt8(4),wtInitStatus:(0,o.readBitFromUInt8)(r.readUInt8(5),0,2),mntAlgStatus:(0,o.readBitFromUInt8)(r.readUInt8(5),2,3),insInitStatus:(0,o.readBitFromUInt8)(r.readUInt8(5),5,2),imuInitStatus:(0,o.readBitFromUInt8)(r.readUInt8(6),0,2),fusionMode:r.readUInt8(12),numSens:r.readUInt8(15),sensors:[]},t=0;t<e.numSens;t++){var n=r.subarray(16+4*t,20+4*t);4==n.length&&e.sensors.push({type:(0,o.readBitFromUInt8)(n.readUInt8(0),0,6),used:1==(0,o.readBitFromUInt8)(n.readUInt8(0),6),ready:1==(0,o.readBitFromUInt8)(n.readUInt8(0),7),calibStatus:(0,o.readBitFromUInt8)(n.readUInt8(1),0,2),timeStatus:(0,o.readBitFromUInt8)(n.readUInt8(1),2,2),freq:n.readUInt8(2),badMeas:(0,o.readBitFromUInt8)(n.readUInt8(3),0),badTTag:(0,o.readBitFromUInt8)(n.readUInt8(3),1),missingMeas:(0,o.readBitFromUInt8)(n.readUInt8(3),2),noisyMeas:(0,o.readBitFromUInt8)(n.readUInt8(3),3)})}return e},e}(t(89).PacketParser);e.UBX_ESF_STATUS_Parser=i},633:function(r,e,t){var n,a=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_MON_VER_Parser=void 0;var o=function(r){function e(){return r.call(this,10,4)||this}return a(e,r),e.prototype.parse=function(r){for(var e=[],t=40;t<r.length-30;t+=30){var n=r.subarray(t,t+30);e.push(n.toString("ascii",0,n.indexOf(0)))}var a=r.subarray(0,30),o=r.subarray(30,40);return{swVersion:a.toString("ascii",0,a.indexOf(0)),hwVersion:o.toString("ascii",0,o.indexOf(0)),extension:e}},e}(t(89).PacketParser);e.UBX_MON_VER_Parser=o},425:function(r,e,t){var n,a=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_NAV_PVT_Parser=void 0;var o=t(287),i=function(r){function e(){return r.call(this,1,7)||this}return a(e,r),e.prototype.parse=function(r){return{iTOW:r.readUInt32LE(0),year:r.readUInt16LE(4),month:r.readUInt8(6),day:r.readUInt8(7),hour:r.readUInt8(8),min:r.readUInt8(9),sec:r.readUInt8(10),validDate:1==(0,o.readBitFromUInt8)(r.readUInt8(11),0),validTime:1==(0,o.readBitFromUInt8)(r.readUInt8(11),1),fullyResolved:1==(0,o.readBitFromUInt8)(r.readUInt8(11),2),validMag:1==(0,o.readBitFromUInt8)(r.readUInt8(11),3),tAcc:r.readUInt32LE(12),nano:r.readInt32LE(16),fixType:r.readUInt8(20),gnssFixOK:1==(0,o.readBitFromUInt8)(r.readUInt8(21),0),diffSoln:1==(0,o.readBitFromUInt8)(r.readUInt8(21),1),psmState:(0,o.readBitFromUInt8)(r.readUInt8(21),2,3),headVehValid:1==(0,o.readBitFromUInt8)(r.readUInt8(21),5),carrSoln:(0,o.readBitFromUInt8)(r.readUInt8(21),6,2),confirmedAvai:1==(0,o.readBitFromUInt8)(r.readUInt8(22),5),confirmedDate:1==(0,o.readBitFromUInt8)(r.readUInt8(22),6),confirmedTime:1==(0,o.readBitFromUInt8)(r.readUInt8(22),7),numSV:r.readUInt8(23),lon:1e-7*r.readInt32LE(24),lat:1e-7*r.readInt32LE(28),height:r.readInt32LE(32),hMSL:r.readInt32LE(36),hAcc:r.readUInt32LE(40),vAcc:r.readUInt32LE(44),velN:r.readInt32LE(48),velE:r.readInt32LE(52),velD:r.readInt32LE(56),gSpeed:r.readInt32LE(60),headMot:1e-5*r.readInt32LE(64),sAcc:r.readUInt32LE(68),headAcc:1e-5*r.readUInt32LE(72),pDOP:.01*r.readUInt16LE(76),invalidLlh:1==(0,o.readBitFromUInt16)(r.readUInt16LE(78),0),lastCorrectionAge:(0,o.readBitFromUInt16)(r.readUInt16LE(78),1,4),headVeh:1e-5*r.readInt32LE(84),magDec:.01*r.readInt16LE(88),magAcc:.01*r.readUInt16LE(90)}},e}(t(89).PacketParser);e.UBX_NAV_PVT_Parser=i},477:function(r,e,t){var n,a=this&&this.__extends||(n=function(r,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])},n(r,e)},function(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=r}n(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_NAV_SAT_Parser=void 0;var o=t(287),i=function(r){function e(){return r.call(this,1,53)||this}return a(e,r),e.prototype.parse=function(r){for(var e=[],t=r.subarray(8),n=0;n<=t.length-12;n+=12){var a=t.subarray(n,n+12);e.push({gnssId:a[0],svId:a[1],cno:a[2],elev:a.readInt8(3),azim:a.readInt16LE(4),prRes:a.readInt16LE(6),lastCorrectionAge:(0,o.readBitFromUInt32)(a.readUInt16LE(8),0,3),svUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),3)>0,health:(0,o.readBitFromUInt32)(a.readUInt16LE(8),4,2),diffCorr:(0,o.readBitFromUInt32)(a.readUInt16LE(8),6)>0,smoothed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),7)>0,orbitSource:(0,o.readBitFromUInt32)(a.readUInt16LE(8),8,3),ephAvail:(0,o.readBitFromUInt32)(a.readUInt16LE(8),11)>0,almAvail:(0,o.readBitFromUInt32)(a.readUInt16LE(8),12)>0,anoAvail:(0,o.readBitFromUInt32)(a.readUInt16LE(8),13)>0,aopAvail:(0,o.readBitFromUInt32)(a.readUInt16LE(8),14)>0,sbasCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),16)>0,rtcmCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),17)>0,slasCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),18)>0,spartnCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),19)>0,prCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),20)>0,crCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),21)>0,doCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),22)>0,clasCorrUsed:(0,o.readBitFromUInt32)(a.readUInt16LE(8),23)>0})}return{iTOW:r.readUint32LE(0),version:r[4],numSvs:r[5],svs:e}},e}(t(89).PacketParser);e.UBX_NAV_SAT_Parser=i},855:(r,e)=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.UBX_GnssId=void 0,(t=e.UBX_GnssId||(e.UBX_GnssId={}))[t.GPS=0]="GPS",t[t.SBAS=1]="SBAS",t[t.GALILEO=2]="GALILEO",t[t.BEIDOU=3]="BEIDOU",t[t.QZSS=5]="QZSS",t[t.GLONASS=6]="GLONASS",t[t.NAVIC=7]="NAVIC"}},e={};return function t(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return r[n].call(o.exports,o,o.exports,t),o.exports}(432)})()));